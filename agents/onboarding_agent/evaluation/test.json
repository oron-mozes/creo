[
  {
    "name": "user_provides_website_url",
    "description": "User provides a website URL, agent should search and extract business info",
    "user_message": "Yes, here is my website: https://www.almacafe.co.il/ourplaces/rehovot",
    "session_context": {},
    "expected_behavior": {
      "should_use_google_search": true,
      "should_extract_business_info": true,
      "should_generate_confirmation_block": true,
      "should_ask_for_confirmation": true
    },
    "expected_business_card": {
      "name": "Alma Cafe",
      "website": "https://www.almacafe.co.il/ourplaces/rehovot",
      "location": "Rehovot, Israel",
      "service_type": "Coffee shop"
    }
  },
  {
    "name": "user_provides_business_name_and_location",
    "description": "User provides business name and location, agent should search for details",
    "user_message": "My business is called TechStart and we're located in San Francisco",
    "session_context": {},
    "expected_behavior": {
      "should_use_google_search": true,
      "should_extract_business_info": true,
      "should_generate_confirmation_block": true,
      "should_ask_for_confirmation": true
    }
  },
  {
    "name": "user_confirms_business_details",
    "description": "User confirms the business details presented",
    "user_message": "Yes, that's correct!",
    "session_context": {
      "last_agent_message": "Business Name: Alma Cafe\\nLocation: Rehovot, Israel\\nService Type: Coffee shop\\n\\nDoes everything look correct?"
    },
    "expected_behavior": {
      "should_generate_confirmation_block": true,
      "should_thank_user": true
    }
  },
  {
    "name": "user_confirms_extracted_business_details_should_save",
    "description": "CRITICAL: After user confirms extracted business details, agent MUST call save_business_card tool",
    "user_message": "yes it does. how did you do it? that is great",
    "session_context": {
      "last_agent_message": "Great! I've found some details about your business. Can you take a quick look and tell me if everything here is correct for Alma Cafe?\\n\\nBusiness Name: Alma Cafe\\nLocation: Rehovot, Israel\\nService Type: Coffee shop\\nWebsite: https://www.almacafe.co.il/ourplaces/rehovot\\n\\nDoes that all look good?"
    },
    "expected_behavior": {
      "should_call_save_business_card_tool": true,
      "should_include_business_name_in_tool_call": true,
      "should_include_location_in_tool_call": true,
      "should_include_service_type_in_tool_call": true,
      "should_include_website_in_tool_call": true,
      "should_thank_user": true,
      "should_indicate_onboarding_complete": true
    },
    "expected_business_card": {
      "name": "Alma Cafe",
      "location": "Rehovot, Israel",
      "service_type": "Coffee shop",
      "website": "https://www.almacafe.co.il/ourplaces/rehovot"
    },
    "expected_tool_calls": [
      {
        "tool_name": "save_business_card",
        "parameters_contain": {
          "name": "Alma Cafe",
          "location": "Rehovot",
          "service_type": "Coffee shop",
          "website": "almacafe.co.il"
        }
      }
    ]
  },
  {
    "name": "new_user_with_minimal_info",
    "description": "New user provides minimal information, agent should ask for more",
    "user_message": "I have a local coffee shop",
    "session_context": {},
    "expected_behavior": {
      "should_ask_for_missing_info": true,
      "should_not_generate_confirmation_block": true
    }
  },
  {
    "name": "user_provides_social_media_handle",
    "description": "User provides Instagram handle, agent should ignore it and ask for business name (social discovery descoped)",
    "user_message": "My Instagram is @almacafe_rehovot",
    "session_context": {},
    "expected_behavior": {
      "should_ask_for_business_name": true,
      "should_not_use_google_search": true
    }
  },
  {
    "name": "vague_generic_question_no_context",
    "description": "User asks vague question with no business context clues",
    "user_message": "Can you help me with marketing?",
    "session_context": {},
    "expected_behavior": {
      "should_ask_for_business_name": true,
      "should_ask_for_industry_or_service_type": true,
      "should_not_generate_confirmation_block": true,
      "should_be_conversational_and_welcoming": true
    },
    "expected_response_contains": [
      "business",
      "brand"
    ]
  },
  {
    "name": "user_provides_comprehensive_info_upfront",
    "description": "User volunteers multiple pieces of info in one sentence",
    "user_message": "I run a sustainable fashion brand in LA called EcoWear",
    "session_context": {},
    "expected_behavior": {
      "should_extract_name": true,
      "should_extract_location": true,
      "should_extract_service_type": true,
      "should_use_google_search": true,
      "should_generate_confirmation_block": true
    },
    "expected_business_card_contains": {
      "name": "EcoWear",
      "location": "LA",
      "service_type": "sustainable fashion"
    }
  },
  {
    "name": "user_asks_clarifying_question",
    "description": "User confused about what agent is asking, seeks clarification",
    "user_message": "What do you mean by location?",
    "session_context": {
      "last_agent_message": "What's your brand name and where is your business located?"
    },
    "expected_behavior": {
      "should_provide_clarification": true,
      "should_give_location_examples": true,
      "should_not_generate_confirmation_block": true,
      "should_remain_patient_and_helpful": true
    },
    "expected_response_contains": [
      "city",
      "example"
    ]
  },
  {
    "name": "user_provides_business_name_only",
    "description": "User provides only business name, no location or other context",
    "user_message": "My business is called StyleHub",
    "session_context": {},
    "expected_behavior": {
      "should_ask_for_more_info": true,
      "should_not_generate_confirmation_block": true
    }
  },
  {
    "name": "user_provides_tiktok_handle",
    "description": "User provides TikTok handle, agent should ignore it and ask for business name (social discovery descoped)",
    "user_message": "Check out our TikTok @ecowear_official",
    "session_context": {},
    "expected_behavior": {
      "should_ask_for_business_name": true,
      "should_not_use_google_search": true
    }
  },
  {
    "name": "user_corrects_information_during_confirmation",
    "description": "User corrects details when asked for confirmation",
    "user_message": "No, the location is wrong - we're actually in San Jose, not San Francisco",
    "session_context": {
      "last_agent_message": "Business Name: TechStart\\nLocation: San Francisco, CA\\nService Type: Tech startup\\n\\nDoes everything look correct?"
    },
    "expected_behavior": {
      "should_acknowledge_correction": true,
      "should_update_location": true,
      "should_present_updated_info_for_confirmation": true,
      "should_not_generate_confirmation_block_yet": true
    },
    "expected_response_contains": [
      "San Jose"
    ]
  },
  {
    "name": "user_provides_linkedin_profile",
    "description": "User provides LinkedIn company profile URL, agent should ignore it and ask for business name",
    "user_message": "Here's our LinkedIn: linkedin.com/company/techstart-inc",
    "session_context": {},
    "expected_behavior": {
      "should_ask_for_business_name": true
    }
  },
  {
    "name": "user_provides_partial_url",
    "description": "User provides domain without https protocol",
    "user_message": "Our site is almacafe.co.il",
    "session_context": {},
    "expected_behavior": {
      "should_use_google_search": true,
      "should_construct_full_url": true,
      "should_extract_business_info": true
    }
  },
  {
    "name": "user_gives_address_instead_of_location",
    "description": "User provides full street address instead of city",
    "user_message": "We're at 123 Main Street, Suite 400, New York, NY 10001",
    "session_context": {
      "last_agent_message": "What's your brand name and where is your business located?"
    },
    "expected_behavior": {
      "should_ask_for_business_name": true
    }
  },
  {
    "name": "extract_all_fields_display_stage_a",
    "description": "User provides all required fields (name, location, service_type) and an optional website in one message. Agent should extract, normalize, and immediately display the Stage A confirmation block.",
    "user_message": "My company is 'Global Innovations', we're based in Berlin, Germany, and we do software development. Our site is globalinnovations.com/contact",
    "session_context": {},
    "expected_behavior": {
      "should_extract_name": true,
      "should_extract_location": true,
      "should_extract_service_type": true,
      "should_extract_website": true,
      "should_normalize_location": true,
      "should_normalize_website": true,
      "should_not_call_google_search": true,
      "should_display_stage_a_confirmation": true,
      "should_not_save_business_card": true
    },
    "expected_response_contains": [
      "Business Name: Global Innovations",
      "Location: Berlin, Germany",
      "Service Type: software development",
      "Website: globalinnovations.com",
      "Does everything look correct?"
    ]
  },
  {
    "name": "website_with_path_search_finds_all_stage_a",
    "description": "User provides only a website with protocol and path. Agent should normalize the URL, use google_search to find all required fields, and then display the Stage A confirmation.",
    "user_message": "Check out our website: https://www.creativecreations.co.uk/about-us",
    "session_context": {},
    "expected_behavior": {
      "should_extract_website": true,
      "should_normalize_website": true,
      "should_call_normalize_url": true,
      "should_call_google_search": true,
      "should_display_stage_a_confirmation": true,
      "should_not_save_business_card": true
    },
    "expected_response_contains": [
      "Business Name: Creative Creations",
      "Location: London, UK",
      "Service Type: Digital Marketing Agency",
      "Website: creativecreations.co.uk",
      "Does everything look correct?"
    ]
  },
  {
    "name": "confirm_stage_a_to_stage_b_and_save",
    "description": "Agent previously displayed a Stage A confirmation block. User confirms the information. Agent should display Stage B confirmation and call save_business_card.",
    "user_message": "Yes, that's all correct!",
    "session_context": {
      "business_card_data": {
        "name": "Creative Creations",
        "location": "London, UK",
        "service_type": "Digital Marketing Agency",
        "website": "creativecreations.co.uk"
      },
      "last_agent_message": "Business Name: Creative Creations\nLocation: London, UK\nService Type: Digital Marketing Agency\nWebsite: creativecreations.co.uk\n\nDoes everything look correct?"
    },
    "expected_behavior": {
      "should_display_stage_b_confirmation": true,
      "should_call_save_business_card": true
    },
    "expected_response_contains": [
      "BUSINESS_CARD_CONFIRMATION:",
      "Saving business card now."
    ],
    "expected_business_card": {
      "name": "Creative Creations",
      "location": "London, UK",
      "service_type": "Digital Marketing Agency",
      "website": "creativecreations.co.uk"
    }
  },
  {
    "name": "missing_name_prompt",
    "description": "User provides location, service_type, and website, but no business name. Agent should extract available info and prompt for the missing name.",
    "user_message": "We're a small coffee shop in Portland, Oregon. Our website is thedailygrind.com",
    "session_context": {},
    "expected_behavior": {
      "should_extract_location": true,
      "should_extract_service_type": true,
      "should_extract_website": true,
      "should_normalize_location": true,
      "should_normalize_website": true,
      "should_not_call_google_search": true,
      "should_prompt_for_name": true,
      "should_not_display_confirmation": true
    },
    "expected_response_contains": [
      "What's your business name?"
    ]
  },
  {
    "name": "name_and_full_address_search_missing_service_type",
    "description": "User provides name and a full street address. Agent should normalize the location, attempt a google_search, and if service_type is still missing, prompt for it.",
    "user_message": "Our business is 'Urban Gardens' and we're located at 789 Oak Avenue, Suite 100, Seattle, WA 98101.",
    "session_context": {},
    "expected_behavior": {
      "should_extract_name": true,
      "should_extract_location": true,
      "should_normalize_location": true,
      "should_call_google_search": true,
      "should_prompt_for_service_type": true,
      "should_not_display_confirmation": true
    },
    "expected_response_contains": [
      "What type of service does Urban Gardens provide?"
    ]
  },
  {
    "name": "irrelevant_text_extract_partial_info_prompt",
    "description": "User message contains irrelevant text mixed with some valid business information. Agent should extract only the relevant parts and prompt for missing required fields.",
    "user_message": "Hey there! My cat's name is Mittens. Anyway, my business is 'FutureTech Solutions'. We're in Boston. I need to register it.",
    "session_context": {},
    "expected_behavior": {
      "should_extract_name": true,
      "should_extract_location": true,
      "should_ignore_irrelevant_text": true,
      "should_not_call_google_search": true,
      "should_prompt_for_service_type": true,
      "should_not_display_confirmation": true
    },
    "expected_response_contains": [
      "What type of service does FutureTech Solutions provide?"
    ]
  },
  {
    "name": "user_corrects_location_redisplay_stage_a",
    "description": "Agent previously displayed Stage A confirmation with an incorrect location. User corrects the location. Agent should update the field and redisplay Stage A.",
    "user_message": "Actually, we're in Dallas, Texas, not Austin.",
    "session_context": {
      "business_card_data": {
        "name": "Pioneer Logistics",
        "location": "Austin, TX",
        "service_type": "Logistics Services",
        "website": "pioneerlogistics.com"
      },
      "last_agent_message": "Business Name: Pioneer Logistics\nLocation: Austin, TX\nService Type: Logistics Services\nWebsite: pioneerlogistics.com\n\nDoes everything look correct?"
    },
    "expected_behavior": {
      "should_update_location": true,
      "should_normalize_location": true,
      "should_display_stage_a_confirmation": true,
      "should_not_call_google_search": true,
      "should_not_save_business_card": true
    },
    "expected_response_contains": [
      "Business Name: Pioneer Logistics",
      "Location: Dallas, TX",
      "Service Type: Logistics Services",
      "Website: pioneerlogistics.com",
      "Does everything look correct?"
    ]
  },
  {
    "name": "generic_name_only_insufficient_search_prompt_location",
    "description": "User provides only a generic business name. Agent attempts google_search, finds insufficient info due to ambiguity, and then prompts for location.",
    "user_message": "My business is 'The Corner Store'.",
    "session_context": {},
    "expected_behavior": {
      "should_extract_name": true,
      "should_call_google_search": true,
      "should_find_search_insufficient": true,
      "should_prompt_for_location": true,
      "should_not_display_confirmation": true
    },
    "expected_response_contains": [
      "What's your business location?"
    ]
  },
  {
    "name": "website_search_finds_only_name_prompt_location",
    "description": "User provides only a website. Agent normalizes URL, performs google_search, which only yields the business name. Agent then prompts for location.",
    "user_message": "Our website is innovatesolutions.net",
    "session_context": {},
    "expected_behavior": {
      "should_extract_website": true,
      "should_normalize_website": true,
      "should_call_normalize_url": true,
      "should_call_google_search": true,
      "should_find_name_only_from_search": true,
      "should_prompt_for_location": true,
      "should_not_display_confirmation": true
    },
    "expected_response_contains": [
      "What's your business location?"
    ]
  },
  {
    "name": "multiple_missing_fields_first_prompt_name",
    "description": "User provides minimal information (only service type). Agent should identify name as the first missing required field and prompt for it.",
    "user_message": "We provide custom software development.",
    "session_context": {},
    "expected_behavior": {
      "should_extract_service_type": true,
      "should_not_call_google_search": true,
      "should_prompt_for_name": true,
      "should_not_display_confirmation": true
    },
    "expected_response_contains": [
      "What's your business name?"
    ]
  }
]